# 带有 CRT 合并的 Berlekamp-Massey 算法

## 简介

Berlekamp-Massey（BM）算法是一种用于求解线性递推关系的算法。然而，当递推式为非线性时，通常需要对其指数进行线性化处理。本文介绍了一种结合中国剩余定理（CRT）的方法，以处理非线性递推式的指数情况。

## 背景

非线性递推式通常表现为乘积形式：f1 * f2 * ...，其指数是线性的。因此，可以分别对 f1, f2, f3, f4 应用 BM 算法。然而，处理指数时需要进行模运算，这涉及到欧拉函数的应用。通常，模数选为 \(1e9 + 7\)，但经过欧拉函数处理后，模数变为 \(1e9 + 6\)。

原有的 BM 算法在某些步骤中应用了费马小定理。然而，当模数不一定为质数时，费马小定理不再适用。因此，需要采用不依赖费马小定理的 BM 算法版本。

## 解决方案

解决方案是将费马小定理求逆元的过程替换为质因数分解结合中国剩余定理：

1. **质因数分解**：对每个模数进行质因数分解。
2. **应用中国剩余定理**：结合各个质因数的结果，重建解。

### 费马小定理

费马小定理用于求逆元：若 \(p\) 为质数，且 \(a\) 不为 \(p\) 的倍数，则有：

\[ a^{p-1} \equiv 1 \pmod{p} \]

逆元为：

\[ a^{-1} \equiv a^{p-2} \pmod{p} \]

### 质因数分解与中国剩余定理

#### 质因数分解

对于一个非质数模数 \(m\)，我们进行质因数分解：

\[ m = p_1^{k_1} \times p_2^{k_2} \times \ldots \times p_n^{k_n} \]

#### 中国剩余定理

CRT 用于将多个模数的解组合为一个统一解。对于方程组：

\[ x \equiv a_i \pmod{n_i} \]

我们可以找到唯一解 \(x\) 满足：

\[ x \equiv a_i \pmod{n_i} \]

通过 CRT，我们可以将各个质因数的结果合并，重建整体解。



